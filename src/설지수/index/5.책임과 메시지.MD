## 책임과 메시지

 이 단원에 들어가기 앞서, 저자는 방관자 효과를 예시를 든다.
 
**방관자 효과**

    주위에 사람이 많을수록 어려움에 처한 사람을 돕지 않는 현상

이 효과가 객체지향 세계에서 어떤 상관이 있는가?

대부분의 사람들은 자신에게 명확한 책임이 없는 경우에는 지하철에서 발작을
일으킨 환자를 도와주는 일을 타인의 책임으로 간주해버린다. 그에 반해
지하철에 도와줄 사람이 아무도 없어 혼자만 그 환자를 목격했다면(책임이 명확하게 주어질 경우)
신속하게 위기 상황을 해결하려고 노력한다. 객체지향 세계에서도 마찬가지이다.

훌륭한 객체지향의 세계는 **명확하게 정의된 역할**과 **책임**을 지닌 객체들이 상호 협력하는 세계다.

### 자율적인 책임

**책임**

     요청을 처리하기 위해 객체가 수행하는 행동

객체가 자율적이기 위해서는 객체에게 할당되는 책임 역시 자율적이어야 한다.

챕터 4에서 작성했던 앨리스의 이야기의 내용 중 `왕`이 `증인`에게 **증언하라** 요청했던 내용이 있었다.
그런데 만약 **증언하라** 한게 아닌 증언하는 **방법**을 구체적으로, **ppt를 이용하여 증언하라**
라고 한다거나, **메모한 내용을 읽어라** 라고 `요청`한다면?

상세한 수준의 책임은 **증언하라** 라는 최종 묙표를 만족시킬지 몰라도,
증인이 누려야 할 증언하는 방법의 **선택의 자유**를 크게 훼손하고 만다.

객체의 책임은 그 객체의 자율성을 충분히 보장할 수 있을 정도로 포괄적이고
**추상적**이면서 해야 할 일을 명확하게 지시해야 한다.

하지만 협력의 의도를 명확하게 표현하지 못할 정도로 추상적인 것 또한 문제다.
만약 저 내용에서 증인에게 **증언하라** 하는 것이 아닌, **설명해라** 라고 한다면?
증인은 증언하는 것이 아닌 재판이라는 단어를 설명할 수도 있다.

어떤 책임이 자율적인지 판단하는 기준은 문맥에 따라 다르다는 것을 유의하자.

결국, **자율적인 책임의 특징**은 객체가 `어떻게` 해야 하는가가 아니라
`무엇을` 해야 하는가를 설명한다는 것이다.

### 메시지
메시지 전송은 `수신자`, `메시지 이름`, `인자`의 조합으로 구성된다.

메시지를 수신받은 객체는 우선 자신이 해당 메시지를 처리할 수 있는지 확인한다.
(return 타입이라 생각)

객체가 수신할 수 있는 메시지의 모양 = 객체가 수행할 책임의 모양


객체지향 애플리케이션은 클래스를 이용해 만들어지지만 메시지를 통해 정의된다.

클래스는 단지 동적인 객체들의 특성과 행위를 정적인 텍스트로 표현하기 위해 사용할 수 있는 추상화 도구일 뿐이다.
클레스를 정의하는 것이 먼저가 아니라 객체들의 속성과 행위를 식별하는 것이 먼저다.

### 다형성
다형성은 수신자의 종류를 캡슐화한다. (인터페이스를 생각하면 쉬움)

**다형성의 장점**
- 협력이 유연해진다.
- 협력이 수행되는 방식을 확장할 수 있다.
- 협력이 수행되는 방식을 재사용할 수 있다.

무엇이 다형성을 가능하게 하는가? -> 메시지

## 책임 주도 설계
책임 주도 설계의 핵심은 어떤 행위가 필요한지를 먼저 결정한 후
이 행위를 수행할 객체를 결정하는 것이다.(`what/ who` 사이클)

메시지를 먼저 결정함으로써, **객체의 인터페이스를 발견**할 수 있다.

메시지를 먼저 결정하고 객체가 메시지를 따르게 하는 설계 방식은 객체가 외부에 제공하는 인터페이스가
독특한 스타일을 따르게 한다.
(데메테르 법칙, Law of Demeter)

### 객체 인터페이스

내가 배운 인터페이스의 단어의 의미는 `접점`이였다.
저자는 인터페이스를 이렇게 말한다.

    어떤 두 사물이 마주치는 경계 지점에서 서로 상호작용 할 수 있게 이어주는 방법이나 장치

**인터페이스의 특징**
- 인터페이스의 사용법을 익히기만 하면 내부 구조나 동작 방식을 몰라도 대상을 조작하거나 의사를 전달할 수 있음.
- 인터페이스 자체는 변경하지 않고 단순히 내부 구성이나 작동 방식만을 변경하는 것은 사용자에게 어떤 영향도 미치지 않는다.
- 대상이 변경되더라도 동일한 인터페이스를 제공하기만 한다면 아무런 문제 없이 상호작용할 수 있다.

내부에서만 접근 가능한 사적인 인터페이스와 구분하기 위해 외부에 공개된 인터페이스를 **공용 인터페이스**라 한다.(public?)

**객체지향적인 사고 방식을 위한 세 가지 원칙**
- 좀 더 추상적인 인터페이스
- 최소 인터페이스
- 인터페이스와 **구현** 간에 차이가 있다는 점을 인식

객체의 외부와 내부를 **명확하게 분리하는 것**이 중요하다.

객체 내부의 구조와 작동 방식을 가리키는 고유의 용어가 `구현(implementation)`이다.
객체를 구성하지만 공용 인터페이스에 포함되지 않는 모든 것이 구현에 포함된다.(객체의 상태나 행동)

### 인터페이스와 구현의 분리 원칙
객체를 설계할 때 객체 외부에 노출되는 인터페이스와 객체의 내부에 숨겨지는 구현을 명확하게 분리해서 고려해야 한다는 것이다.

이유는 무엇인가?
**변경을 관리하기 위한 것**이다. 구체적으로 말하면
송신자와 수신자가 구체적인 구현 부분이 아닌 느슨한 인터페이스에 대해서만 결합되도록 만드는 것.

인터페이스와 구현을 분리한다는 것은 변경될 만한 부분을 객체의 내부에 꽁꽁 숨겨놓는다는 것을 의미한다.
일반적으로 이 원칙을 수행하기 위한 객체 설계 방법을 캡슐화라고 한다.


### 캡슐화
     객체의 자율성을 보존하기 위해 구현을 외부로부터 감추는 것

**캡슐화의 두가지 관점**
- 상태와 행위의 캡슐화 : 객체는 상태와 행동을 가지고 있다.
  객체는 스스로 자신의 상태를 관리하며 상태를 변경하고 외부에 응당할 수 있는 행동을 내부에 함께 보관한다.(데이터 캡슐화)
- 사적인 비밀의 캡슐화 :
  외부에 제공해야 할 필요가 있는 메시지만을 객체의 공용 인터페이스에 포함시키고,
  내부의 비밀은 뒤로 감춤으로써 외부의 불필요한 공격과 간섭으로부터 내부 상태를 격리시킬 수  있다. = 공용 인터페이스를 경계로 자율성을 보장

**객체를 자율적인 존재로 바라보는 것은 객체의 내부와 외부를 엄격하게 분리한다는 것을 의미한다.**

### 책임의 자율성이 협력의 품질을 결정한다

책임이 얼마나 자율적인지가 전체적인 협력의 설계 품질을 결정하게 된다.

- 자율적인 책임은 협력을 단순하게 만든다. (책임의 추상화)
- 자율적인 책임은 인터페이스의 외부와 내부를 명확하게 분리한다.
- 책임이 자율적일 경우 책임을 수행하는 내부적인 장법을 변경하더라도 외부에 영향을 미치지 않는다.
- 자율적인 책임은 협력의 대상을 다양하게 선택할 수 있는 유연성을 제공한다.

책임이 **자율적**일수록 적절하게 `추상화`되며, `응집도`가 높아지고, `결합도`가 낮아지며, `캡슐화`가 증진되고,
`인터페이스와 구현이 명확하게 분리`되며, 설계의 `유연성`과 `재사용성`이 향상된다.
